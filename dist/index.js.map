{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\nimport './index.scss';\n\nexport default class extends Controller {\n  static values = {\n    growWidth: String,\n    growHeight: String\n  }\n  static actions = [\n    ['element', 'dragenter->enter'],\n    ['element', 'dragleave->leave'],\n    ['element', 'drop->drop'],\n    ['element', 'dragover@document->overDoc'],\n    ['element', 'dragleave@document->leaveDoc'],\n    ['element', 'drop@document->dropDoc']\n  ];\n\n  get input() {\n    return this.scope.findElement('input[type=file]');\n  }\n\n  connect() {\n    this.counter = 0;\n  }\n\n  enter(e) {\n    this.counter++;\n    this.element.classList.add('st-dropzone--dragover');\n    e.preventDefault();\n  }\n\n  leave(e) {\n    this.counter--;\n    if (this.counter == 0) {\n      this.element.classList.remove('st-dropzone--dragover');\n    }\n    e.preventDefault();\n  }\n\n  drop(e) {\n    this.counter = 0;\n    this.element.classList.remove('st-dropzone--dragover');\n\n    if (this.input) {\n      this.input.files = e.dataTransfer.files;\n      this.input.dispatchEvent(new Event('change', { bubbles: true, cancelable: true }));\n    }\n    this.dispatch('dropped', { detail: { files: e.dataTransfer.files } });\n\n    e.preventDefault();\n  }\n\n  overDoc(e) {\n    this.dragging = true;\n    this.dragin()\n    e.preventDefault();\n  }\n\n  leaveDoc(e) {\n    this.dragging = false;\n    if (this.timeout) clearTimeout(this.timeout);\n    this.timeout = setTimeout(() => {\n      if (!this.dragging) this.dragout();\n    } , 200);\n    e.preventDefault();\n  }\n\n  dropDoc(e) {\n    this.dragging = false;\n    this.dragout();\n    e.preventDefault();\n  }\n\n  dragin() {\n    this.element.classList.add('st-dropzone--dragin');\n    if (this.growWidthValue) {\n      this.element.style.minWidth = this.growWidthValue;\n    }\n    if (this.growHeightValue) {\n      this.element.style.minHeight = this.growHeightValue;\n    }\n  }\n\n  dragout() {\n    this.element.classList.remove('st-dropzone--dragin');\n    if (this.growWidthValue) {\n      this.element.style.minWidth = '';\n    }\n    if (this.growHeightValue) {\n      this.element.style.minHeight = '';\n    }\n  }\n}\n"],"names":["Controller","input","scope","findElement","connect","this","counter","enter","e","element","classList","add","preventDefault","leave","remove","drop","files","dataTransfer","dispatchEvent","Event","bubbles","cancelable","dispatch","detail","overDoc","dragging","dragin","leaveDoc","timeout","clearTimeout","setTimeout","dragout","dropDoc","growWidthValue","style","minWidth","growHeightValue","minHeight","values","growWidth","String","growHeight","actions"],"mappings":"+FAI6BA,aAcvBC,YACF,YAAYC,MAAMC,YAAY,oBAGhCC,UACEC,KAAKC,QAAU,EAGjBC,MAAMC,GACJH,KAAKC,UACLD,KAAKI,QAAQC,UAAUC,IAAI,yBAC3BH,EAAEI,iBAGJC,MAAML,GACJH,KAAKC,UACe,GAAhBD,KAAKC,SACPD,KAAKI,QAAQC,UAAUI,OAAO,yBAEhCN,EAAEI,iBAGJG,KAAKP,GACHH,KAAKC,QAAU,EACfD,KAAKI,QAAQC,UAAUI,OAAO,yBAE1BT,KAAKJ,QACPI,KAAKJ,MAAMe,MAAQR,EAAES,aAAaD,MAClCX,KAAKJ,MAAMiB,cAAc,IAAIC,MAAM,SAAU,CAAEC,SAAS,EAAMC,YAAY,MAE5EhB,KAAKiB,SAAS,UAAW,CAAEC,OAAQ,CAAEP,MAAOR,EAAES,aAAaD,SAE3DR,EAAEI,iBAGJY,QAAQhB,GACNH,KAAKoB,UAAW,EAChBpB,KAAKqB,SACLlB,EAAEI,iBAGJe,SAASnB,GACPH,KAAKoB,UAAW,EACZpB,KAAKuB,SAASC,aAAaxB,KAAKuB,SACpCvB,KAAKuB,QAAUE,WAAW,KACnBzB,KAAKoB,UAAUpB,KAAK0B,WACvB,KACJvB,EAAEI,iBAGJoB,QAAQxB,GACNH,KAAKoB,UAAW,EAChBpB,KAAK0B,UACLvB,EAAEI,iBAGJc,SACErB,KAAKI,QAAQC,UAAUC,IAAI,uBACvBN,KAAK4B,iBACP5B,KAAKI,QAAQyB,MAAMC,SAAW9B,KAAK4B,gBAEjC5B,KAAK+B,kBACP/B,KAAKI,QAAQyB,MAAMG,UAAYhC,KAAK+B,iBAIxCL,UACE1B,KAAKI,QAAQC,UAAUI,OAAO,uBAC1BT,KAAK4B,iBACP5B,KAAKI,QAAQyB,MAAMC,SAAW,IAE5B9B,KAAK+B,kBACP/B,KAAKI,QAAQyB,MAAMG,UAAY,OArF5BC,OAAS,CACdC,UAAWC,OACXC,WAAYD,UAEPE,QAAU,CACf,CAAC,UAAW,oBACZ,CAAC,UAAW,oBACZ,CAAC,UAAW,cACZ,CAAC,UAAW,8BACZ,CAAC,UAAW,gCACZ,CAAC,UAAW"}